<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CoverArt Browser: /home/foss/Downloads/coverart-browser/coverart_entryview.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CoverArt Browser
   &#160;<span id="projectnumber">v2.0</span>
   </div>
   <div id="projectbrief">Browse your cover-art albums in Rhythmbox</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('coverart__entryview_8py.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">/home/foss/Downloads/coverart-browser/coverart_entryview.py</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment"># -*- Mode: python; coding: utf-8; tab-width: 4; indent-tabs-mode: nil; -*-</span>
<a name="l00002"></a>00002 <span class="comment">#</span>
<a name="l00003"></a>00003 <span class="comment"># Copyright (C) 2012 - fossfreedom</span>
<a name="l00004"></a>00004 <span class="comment"># Copyright (C) 2012 - Agustin Carrasco</span>
<a name="l00005"></a>00005 <span class="comment">#</span>
<a name="l00006"></a>00006 <span class="comment"># This program is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"># it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"># the Free Software Foundation; either version 2, or (at your option)</span>
<a name="l00009"></a>00009 <span class="comment"># any later version.</span>
<a name="l00010"></a>00010 <span class="comment">#</span>
<a name="l00011"></a>00011 <span class="comment"># This program is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"># GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment">#</span>
<a name="l00016"></a>00016 <span class="comment"># You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"># along with this program; if not, write to the Free Software</span>
<a name="l00018"></a>00018 <span class="comment"># Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA.</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> RB
<a name="l00023"></a>00023 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> Gtk
<a name="l00024"></a>00024 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> GObject
<a name="l00025"></a>00025 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> GdkPixbuf
<a name="l00026"></a>00026 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> Gdk
<a name="l00027"></a>00027 <span class="keyword">from</span> gi.repository <span class="keyword">import</span> GLib
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">from</span> coverart_rb3compat <span class="keyword">import</span> Menu
<a name="l00030"></a>00030 <span class="keyword">from</span> coverart_rb3compat <span class="keyword">import</span> ActionGroup
<a name="l00031"></a>00031 <span class="keyword">from</span> coverart_browser_prefs <span class="keyword">import</span> GSetting
<a name="l00032"></a>00032 <span class="keyword">from</span> coverart_browser_prefs <span class="keyword">import</span> CoverLocale
<a name="l00033"></a>00033 <span class="keyword">from</span> coverart_external_plugins <span class="keyword">import</span> CreateExternalPluginMenu
<a name="l00034"></a>00034 <span class="keyword">from</span> coverart_playlists <span class="keyword">import</span> LastFMTrackPlaylist
<a name="l00035"></a>00035 <span class="keyword">from</span> coverart_playlists <span class="keyword">import</span> EchoNestPlaylist
<a name="l00036"></a>00036 <span class="keyword">from</span> coverart_playlists <span class="keyword">import</span> EchoNestGenrePlaylist
<a name="l00037"></a>00037 <span class="keyword">from</span> coverart_utils <span class="keyword">import</span> create_button_image
<a name="l00038"></a>00038 <span class="keyword">from</span> coverart_external_plugins <span class="keyword">import</span> ExternalPlugin
<a name="l00039"></a>00039 <span class="keyword">from</span> stars <span class="keyword">import</span> ReactiveStar
<a name="l00040"></a>00040 <span class="keyword">from</span> coverart_search <span class="keyword">import</span> CoverSearchPane
<a name="l00041"></a>00041 <span class="keyword">from</span> coverart_widgets <span class="keyword">import</span> PixbufButton
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 MIN_IMAGE_SIZE = 100
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html">00047</a> <span class="keyword">class </span><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html">EntryViewPane</a>(object):
<a name="l00048"></a>00048     <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00049"></a>00049 <span class="stringliteral">        encapulates all of the Track Pane objects</span>
<a name="l00050"></a>00050 <span class="stringliteral">    &#39;&#39;&#39;</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052     <span class="keyword">def </span>__init__(self, shell, plugin, source, entry_view_grid, viewmgr):
<a name="l00053"></a>00053         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aba40dc4c6c94273031b10cbe8b887376">gs</a> = <a class="code" href="classcoverart__browser__prefs_1_1_g_setting.html">GSetting</a>()
<a name="l00054"></a>00054 
<a name="l00055"></a>00055         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a90ebce14f2adae0b3ffa492a572a3283">entry_view_grid</a> = entry_view_grid
<a name="l00056"></a>00056         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a5ebcc442acc4997bf35a580147e55f5e">shell</a> = shell
<a name="l00057"></a>00057         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a965f9855926a0b59f6981c5f5253227f">viewmgr</a> = viewmgr
<a name="l00058"></a>00058         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a504be3f120a33ae0d9892f67d54875dc">plugin</a> = plugin
<a name="l00059"></a>00059         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a> = source
<a name="l00060"></a>00060 
<a name="l00061"></a>00061         <span class="comment"># setup entry-view objects and widgets</span>
<a name="l00062"></a>00062         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afc39f11d541557ee244fab358163b43c">stack</a> = Gtk.Stack()
<a name="l00063"></a>00063         self.stack.set_transition_type(Gtk.StackTransitionType.SLIDE_LEFT_RIGHT)
<a name="l00064"></a>00064         self.stack.set_transition_duration(750)
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         <span class="comment"># create entry views. Don&#39;t allow to reorder until the load is finished</span>
<a name="l00067"></a>00067         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a4a5329db8959c6c4de0563f4213d4864">entry_view_compact</a> = <a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html">CoverArtCompactEntryView</a>(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a5ebcc442acc4997bf35a580147e55f5e">shell</a>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>)
<a name="l00068"></a>00068         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a9251d6b6d22b659d0ac34b8ff352c616">entry_view_full</a> = <a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html">CoverArtEntryView</a>(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a5ebcc442acc4997bf35a580147e55f5e">shell</a>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>)
<a name="l00069"></a>00069         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aea6390b15b8448d14d87a71b0ea1c646">entry_view</a> = self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a4a5329db8959c6c4de0563f4213d4864">entry_view_compact</a>
<a name="l00070"></a>00070         self.shell.props.library_source.get_entry_view().set_columns_clickable(
<a name="l00071"></a>00071             <span class="keyword">False</span>)
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a0bc425acdaa927abcef1ad7dc7e1e48e">entry_view_results</a> = <a class="code" href="classcoverart__entryview_1_1_results_grid.html">ResultsGrid</a>()
<a name="l00074"></a>00074         self.entry_view_results.initialise()
<a name="l00075"></a>00075 
<a name="l00076"></a>00076         self.stack.add_titled(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a0bc425acdaa927abcef1ad7dc7e1e48e">entry_view_results</a>, <span class="stringliteral">&quot;notebook_tracks&quot;</span>, _(<span class="stringliteral">&quot;Tracks&quot;</span>))
<a name="l00077"></a>00077         self.entry_view_grid.attach(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afc39f11d541557ee244fab358163b43c">stack</a>, 0, 0, 3, 1)
<a name="l00078"></a>00078 
<a name="l00079"></a>00079     <span class="keyword">def </span>setup_source(self):
<a name="l00080"></a>00080 
<a name="l00081"></a>00081         colour = self.viewmgr.get_selection_colour()
<a name="l00082"></a>00082         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a7e89776a9c97ccc65607134e8077b404">cover_search_pane</a> = <a class="code" href="classcoverart__search_1_1_cover_search_pane.html">CoverSearchPane</a>(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a504be3f120a33ae0d9892f67d54875dc">plugin</a>, colour)
<a name="l00083"></a>00083 
<a name="l00084"></a>00084         self.stack.add_titled(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a7e89776a9c97ccc65607134e8077b404">cover_search_pane</a>, <span class="stringliteral">&quot;notebook_covers&quot;</span>, _(<span class="stringliteral">&quot;Covers&quot;</span>))
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <span class="comment"># define entry-view toolbar</span>
<a name="l00087"></a>00087         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#abaffc5dfa2993575faa737b852d563d3">stars</a> = <a class="code" href="classstars_1_1_reactive_star.html">ReactiveStar</a>()
<a name="l00088"></a>00088         self.stars.set_rating(0)
<a name="l00089"></a>00089         self.stars.connect(<span class="stringliteral">&#39;changed&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a050679b1c7e8b93fd003e82f83ca550a">rating_changed_callback</a>)
<a name="l00090"></a>00090         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#abaffc5dfa2993575faa737b852d563d3">stars</a>.props.valign = Gtk.Align.CENTER
<a name="l00091"></a>00091         self.entry_view_grid.attach(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#abaffc5dfa2993575faa737b852d563d3">stars</a>, 1, 1, 1, 1)
<a name="l00092"></a>00092         stack_switcher = Gtk.StackSwitcher()
<a name="l00093"></a>00093         stack_switcher.set_stack(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afc39f11d541557ee244fab358163b43c">stack</a>)
<a name="l00094"></a>00094         self.entry_view_grid.attach(stack_switcher, 0, 1, 1, 1)
<a name="l00095"></a>00095         viewtoggle = <a class="code" href="classcoverart__widgets_1_1_pixbuf_button.html">PixbufButton</a>()
<a name="l00096"></a>00096         viewtoggle.set_image(create_button_image(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a504be3f120a33ae0d9892f67d54875dc">plugin</a>, <span class="stringliteral">&quot;entryview.png&quot;</span>))
<a name="l00097"></a>00097         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a306925e6982af2768adf36b70cbf572c">viewtoggle_id</a> = <span class="keywordtype">None</span>
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         setting = self.gs.get_setting(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aba40dc4c6c94273031b10cbe8b887376">gs</a>.Path.PLUGIN)
<a name="l00100"></a>00100         viewtoggle.set_active(<span class="keywordflow">not</span> setting[self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aba40dc4c6c94273031b10cbe8b887376">gs</a>.PluginKey.ENTRY_VIEW_MODE])
<a name="l00101"></a>00101         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a42e507a35a3a9bb412a0abdf0d9a8576">entry_view_toggled</a>(viewtoggle, <span class="keyword">True</span>)
<a name="l00102"></a>00102         viewtoggle.connect(<span class="stringliteral">&#39;toggled&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a42e507a35a3a9bb412a0abdf0d9a8576">entry_view_toggled</a>)
<a name="l00103"></a>00103 
<a name="l00104"></a>00104         smallwindowbutton = <a class="code" href="classcoverart__widgets_1_1_pixbuf_button.html">PixbufButton</a>()
<a name="l00105"></a>00105         smallwindowbutton.set_image(create_button_image(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a504be3f120a33ae0d9892f67d54875dc">plugin</a>, <span class="stringliteral">&quot;view-restore.png&quot;</span>))
<a name="l00106"></a>00106         smallwindowbutton.connect(<span class="stringliteral">&#39;toggled&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a4c5d93986dfdc01b220e20465b9a9e32">smallwindowbutton_callback</a>)
<a name="l00107"></a>00107 
<a name="l00108"></a>00108         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#abe01de6df53f6dbf7a6e8df2d12d3354">smallwindowext</a> = <a class="code" href="classcoverart__external__plugins_1_1_external_plugin.html">ExternalPlugin</a>()
<a name="l00109"></a>00109         self.smallwindowext.appendattribute(<span class="stringliteral">&#39;plugin_name&#39;</span>, <span class="stringliteral">&#39;smallwindow&#39;</span>)
<a name="l00110"></a>00110         self.smallwindowext.appendattribute(<span class="stringliteral">&#39;action_group_name&#39;</span>, <span class="stringliteral">&#39;small window actions&#39;</span>)
<a name="l00111"></a>00111         self.smallwindowext.appendattribute(<span class="stringliteral">&#39;action_name&#39;</span>, <span class="stringliteral">&#39;SmallWindow&#39;</span>)
<a name="l00112"></a>00112         self.smallwindowext.appendattribute(<span class="stringliteral">&#39;action_type&#39;</span>, <span class="stringliteral">&#39;app&#39;</span>)
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         whatsplayingtoggle = <a class="code" href="classcoverart__widgets_1_1_pixbuf_button.html">PixbufButton</a>()
<a name="l00115"></a>00115         whatsplayingtoggle.set_image(create_button_image(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a504be3f120a33ae0d9892f67d54875dc">plugin</a>, <span class="stringliteral">&quot;whatsplaying.png&quot;</span>))
<a name="l00116"></a>00116         whatsplayingtoggle.connect(<span class="stringliteral">&#39;toggled&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a52fcc567fb9e7c3200318c031cda791a">whatsplayingtoggle_callback</a>)
<a name="l00117"></a>00117 
<a name="l00118"></a>00118         rightgrid = Gtk.Grid()
<a name="l00119"></a>00119         rightgrid.props.halign = Gtk.Align.END
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="comment">#rightgrid.attach(whatsplayingtoggle, 0, 0, 1, 1)</span>
<a name="l00122"></a>00122         rightgrid.attach(viewtoggle, 1, 0, 1, 1)
<a name="l00123"></a>00123         rightgrid.attach(smallwindowbutton, 2, 0, 1, 1)
<a name="l00124"></a>00124 
<a name="l00125"></a>00125         self.entry_view_grid.attach_next_to(rightgrid, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#abaffc5dfa2993575faa737b852d563d3">stars</a>, Gtk.PositionType.RIGHT, 1, 1)
<a name="l00126"></a>00126         self.stack.set_visible_child(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a0bc425acdaa927abcef1ad7dc7e1e48e">entry_view_results</a>)
<a name="l00127"></a>00127         self.stack.connect(<span class="stringliteral">&#39;notify::visible-child-name&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#ad1f321012192d461ef920531bd826f64">notebook_switch_page_callback</a>)
<a name="l00128"></a>00128 
<a name="l00129"></a>00129         self.entry_view_grid.show_all()
<a name="l00130"></a>00130         smallwindowbutton.set_visible(self.smallwindowext.is_activated())
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="keyword">def </span>whatsplayingtoggle_callback(self, widget):
<a name="l00133"></a>00133         self.entry_view_results.emit(<span class="stringliteral">&#39;whats-playing&#39;</span>, widget.get_active())
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="keyword">def </span>smallwindowbutton_callback(self, widget):
<a name="l00137"></a>00137         <span class="keywordflow">if</span> widget.get_active():
<a name="l00138"></a>00138             self.smallwindowext.activate(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a5ebcc442acc4997bf35a580147e55f5e">shell</a>)
<a name="l00139"></a>00139             widget.emit(<span class="stringliteral">&#39;clicked&#39;</span>)
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <span class="keyword">def </span>entry_view_toggled(self, widget, initialised=False):
<a name="l00142"></a>00142         print(<span class="stringliteral">&quot;DEBUG - entry_view_toggled&quot;</span>)
<a name="l00143"></a>00143         <span class="keywordflow">if</span> widget.get_active():
<a name="l00144"></a>00144             next_view = self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a9251d6b6d22b659d0ac34b8ff352c616">entry_view_full</a>
<a name="l00145"></a>00145             show_coverart = <span class="keyword">False</span>
<a name="l00146"></a>00146             <span class="keywordflow">if</span> self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a306925e6982af2768adf36b70cbf572c">viewtoggle_id</a>:
<a name="l00147"></a>00147                 self.shell.props.window.disconnect(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a306925e6982af2768adf36b70cbf572c">viewtoggle_id</a>)
<a name="l00148"></a>00148                 self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a306925e6982af2768adf36b70cbf572c">viewtoggle_id</a> = <span class="keywordtype">None</span>
<a name="l00149"></a>00149         <span class="keywordflow">else</span>:
<a name="l00150"></a>00150             next_view = self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a4a5329db8959c6c4de0563f4213d4864">entry_view_compact</a>
<a name="l00151"></a>00151             show_coverart = <span class="keyword">True</span>
<a name="l00152"></a>00152             self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a306925e6982af2768adf36b70cbf572c">viewtoggle_id</a> = self.shell.props.window.connect(<span class="stringliteral">&#39;check_resize&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a0bc425acdaa927abcef1ad7dc7e1e48e">entry_view_results</a>.window_resize)
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         setting = self.gs.get_setting(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aba40dc4c6c94273031b10cbe8b887376">gs</a>.Path.PLUGIN)
<a name="l00155"></a>00155         setting[self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aba40dc4c6c94273031b10cbe8b887376">gs</a>.PluginKey.ENTRY_VIEW_MODE] = <span class="keywordflow">not</span> widget.get_active()
<a name="l00156"></a>00156 
<a name="l00157"></a>00157         self.entry_view_results.change_view(next_view, show_coverart)
<a name="l00158"></a>00158         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aea6390b15b8448d14d87a71b0ea1c646">entry_view</a> = next_view
<a name="l00159"></a>00159         <span class="keywordflow">if</span> <span class="keywordflow">not</span> initialised:
<a name="l00160"></a>00160             self.source.update_with_selection()
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#ad1f321012192d461ef920531bd826f64">00162</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#ad1f321012192d461ef920531bd826f64">notebook_switch_page_callback</a>(self, *args):
<a name="l00163"></a>00163         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00164"></a>00164 <span class="stringliteral">        Callback called when the notebook page gets switched. It initiates</span>
<a name="l00165"></a>00165 <span class="stringliteral">        the cover search when the cover search pane&#39;s page is selected.</span>
<a name="l00166"></a>00166 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00167"></a>00167         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - notebook_switch_page_callback&quot;</span>)
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <span class="keywordflow">if</span> self.stack.get_visible_child_name() == <span class="stringliteral">&#39;notebook_covers&#39;</span>:
<a name="l00170"></a>00170             self.viewmgr.current_view.switch_to_coverpane(self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a7e89776a9c97ccc65607134e8077b404">cover_search_pane</a>)
<a name="l00171"></a>00171         <span class="keywordflow">else</span>:
<a name="l00172"></a>00172             entries = self.entry_view.get_selected_entries()
<a name="l00173"></a>00173             <span class="keywordflow">if</span> entries <span class="keywordflow">and</span> len(entries) &gt; 0:
<a name="l00174"></a>00174                 self.entry_view_results.emit(<span class="stringliteral">&#39;update-cover&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>, entries[0])
<a name="l00175"></a>00175             <span class="keywordflow">else</span>:
<a name="l00176"></a>00176                 selected = self.viewmgr.current_view.get_selected_objects()
<a name="l00177"></a>00177                 tracks = selected[0].get_tracks()
<a name="l00178"></a>00178                 self.entry_view_results.emit(<span class="stringliteral">&#39;update-cover&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>, tracks[0].entry)
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - end notebook_switch_page_callback&quot;</span>)
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a050679b1c7e8b93fd003e82f83ca550a">00182</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a050679b1c7e8b93fd003e82f83ca550a">rating_changed_callback</a>(self, widget):
<a name="l00183"></a>00183         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00184"></a>00184 <span class="stringliteral">        Callback called when the Rating stars is changed</span>
<a name="l00185"></a>00185 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00186"></a>00186         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - rating_changed_callback&quot;</span>)
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         rating = widget.get_rating()
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <span class="keywordflow">for</span> album <span class="keywordflow">in</span> self.viewmgr.current_view.get_selected_objects():
<a name="l00191"></a>00191             album.rating = rating
<a name="l00192"></a>00192 
<a name="l00193"></a>00193         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - end rating_changed_callback&quot;</span>)
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keyword">def </span>get_entry_view(self):
<a name="l00196"></a>00196         <span class="keywordflow">return</span> self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#aea6390b15b8448d14d87a71b0ea1c646">entry_view</a>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="keyword">def </span>update_cover(self, album_artist, manager):
<a name="l00199"></a>00199         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.stack.get_visible_child_name() == <span class="stringliteral">&quot;notebook_covers&quot;</span>:
<a name="l00200"></a>00200             <span class="keywordflow">return</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202         self.cover_search_pane.clear()
<a name="l00203"></a>00203         self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a9c9f669981fcd9cb915fcefe58dd4308">cover_search</a>(album_artist, manager)
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <span class="keyword">def </span>cover_search(self, album_artist, manager):
<a name="l00206"></a>00206         self.cover_search_pane.do_search(album_artist,
<a name="l00207"></a>00207                                          manager.cover_man.update_cover)
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a7f0b305b9ebd3346e80c949b5cce94f8">00209</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#a7f0b305b9ebd3346e80c949b5cce94f8">update_selection</a>(self, last_selected_album, click_count):
<a name="l00210"></a>00210         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00211"></a>00211 <span class="stringliteral">        Update the source view when an item gets selected.</span>
<a name="l00212"></a>00212 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00213"></a>00213         print(<span class="stringliteral">&quot;DEBUG - update_with_selection&quot;</span>)
<a name="l00214"></a>00214         selected = self.viewmgr.current_view.get_selected_objects()
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <span class="comment"># clear the entry view</span>
<a name="l00217"></a>00217         self.entry_view.clear()
<a name="l00218"></a>00218 
<a name="l00219"></a>00219         cover_search_pane_visible = self.stack.get_visible_child_name() == <span class="stringliteral">&quot;notebook_covers&quot;</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="keywordflow">if</span> <span class="keywordflow">not</span> selected:
<a name="l00222"></a>00222             <span class="comment"># clean cover tab if selected</span>
<a name="l00223"></a>00223             <span class="keywordflow">if</span> cover_search_pane_visible:
<a name="l00224"></a>00224                 self.cover_search_pane.clear()
<a name="l00225"></a>00225 
<a name="l00226"></a>00226             self.entry_view_results.emit(<span class="stringliteral">&#39;update-cover&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>, <span class="keywordtype">None</span>)
<a name="l00227"></a>00227             <span class="keywordflow">return</span> last_selected_album, click_count
<a name="l00228"></a>00228         <span class="keywordflow">elif</span> len(selected) == 1:
<a name="l00229"></a>00229             self.stars.set_rating(selected[0].rating)
<a name="l00230"></a>00230 
<a name="l00231"></a>00231             <span class="keywordflow">if</span> selected[0] <span class="keywordflow">is</span> <span class="keywordflow">not</span> last_selected_album:
<a name="l00232"></a>00232                 <span class="comment"># when the selection changes we&#39;ve to take into account two</span>
<a name="l00233"></a>00233                 <span class="comment"># things</span>
<a name="l00234"></a>00234                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> click_count:
<a name="l00235"></a>00235                     <span class="comment"># we may be using the arrows, so if there is no mouse</span>
<a name="l00236"></a>00236                     <span class="comment"># involved, we should change the last selected</span>
<a name="l00237"></a>00237                     last_selected_album = selected[0]
<a name="l00238"></a>00238                 <span class="keywordflow">else</span>:
<a name="l00239"></a>00239                     <span class="comment"># we may&#39;ve doing a fast change after a valid second click,</span>
<a name="l00240"></a>00240                     <span class="comment"># so it shouldn&#39;t be considered a double click</span>
<a name="l00241"></a>00241                     click_count -= 1
<a name="l00242"></a>00242         <span class="keywordflow">else</span>:
<a name="l00243"></a>00243             self.stars.set_rating(0)
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="keywordflow">if</span> len(selected) == 1:
<a name="l00246"></a>00246             self.source.artist_info.emit(<span class="stringliteral">&#39;selected&#39;</span>,
<a name="l00247"></a>00247                                          selected[0].artist,
<a name="l00248"></a>00248                                          selected[0].name)
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         self.entry_view.set_sorting_order(<span class="stringliteral">&#39;track-number&#39;</span>, Gtk.SortType.ASCENDING)
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         <span class="keywordflow">for</span> album <span class="keywordflow">in</span> selected:
<a name="l00253"></a>00253             <span class="comment"># add the album to the entry_view</span>
<a name="l00254"></a>00254             self.entry_view.add_album(album)
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="keywordflow">if</span> len(selected) &gt; 0:
<a name="l00257"></a>00257 
<a name="l00258"></a>00258             <span class="keyword">def </span>cover_update(*args):
<a name="l00259"></a>00259                 <span class="keywordflow">print</span> (<span class="stringliteral">&quot;emitting&quot;</span>)
<a name="l00260"></a>00260                 self.entry_view_results.emit(<span class="stringliteral">&#39;update-cover&#39;</span>,
<a name="l00261"></a>00261                                          self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>,
<a name="l00262"></a>00262                                          selected[0].get_tracks()[0].entry)
<a name="l00263"></a>00263 
<a name="l00264"></a>00264             <span class="comment"># add a short delay to give the entry-pane time to expand etc.</span>
<a name="l00265"></a>00265             Gdk.threads_add_timeout(GLib.PRIORITY_DEFAULT_IDLE, 250, cover_update, <span class="keywordtype">None</span>)
<a name="l00266"></a>00266 
<a name="l00267"></a>00267         <span class="comment"># update the cover search pane with the first selected album</span>
<a name="l00268"></a>00268         <span class="keywordflow">if</span> cover_search_pane_visible:
<a name="l00269"></a>00269             self.cover_search_pane.do_search(selected[0],
<a name="l00270"></a>00270                                              self.<a class="code" href="classcoverart__entryview_1_1_entry_view_pane.html#afe8c40b8620f7518f1053ee9b08c62b3">source</a>.album_manager.cover_man.update_cover)
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">return</span> last_selected_album, click_count
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00275"></a><a class="code" href="classcoverart__entryview_1_1_results_grid.html">00275</a> <span class="keyword">class </span><a class="code" href="classcoverart__entryview_1_1_results_grid.html">ResultsGrid</a>(Gtk.Grid):
<a name="l00276"></a>00276     <span class="comment"># signals</span>
<a name="l00277"></a>00277     __gsignals__ = {
<a name="l00278"></a>00278         <span class="stringliteral">&#39;update-cover&#39;</span>: (GObject.SIGNAL_RUN_LAST, <span class="keywordtype">None</span>, (GObject.Object, RB.RhythmDBEntry)),
<a name="l00279"></a>00279         <span class="stringliteral">&#39;whats-playing&#39;</span>: (GObject.SIGNAL_RUN_LAST, <span class="keywordtype">None</span>, (bool,))
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     image_width = 0
<a name="l00282"></a>00282 
<a name="l00283"></a>00283     <span class="keyword">def </span>__init__(self, *args, **kwargs):
<a name="l00284"></a>00284         super(ResultsGrid, self).__init__(*args, **kwargs)
<a name="l00285"></a>00285 
<a name="l00286"></a>00286     <span class="keyword">def </span>initialise(self):
<a name="l00287"></a>00287         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a75972b79a4e6ec88a0a3fc51d5981359">pixbuf</a> = <span class="keywordtype">None</span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a4cf125cb660a8c3c44df5b9dc38eff17">oldval</a> = 0
<a name="l00290"></a>00290         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a6464e57c9b46119f839aa84297d68cae">stack</a> = Gtk.Stack()
<a name="l00291"></a>00291         self.stack.set_transition_type(Gtk.StackTransitionType.CROSSFADE)
<a name="l00292"></a>00292         self.stack.set_transition_duration(350)
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#ad04a197d8811a2ae2c72157bcff3e0c0">image1</a> = Gtk.Image()
<a name="l00295"></a>00295         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#ad04a197d8811a2ae2c72157bcff3e0c0">image1</a>.props.hexpand = <span class="keyword">True</span>
<a name="l00296"></a>00296         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#ad04a197d8811a2ae2c72157bcff3e0c0">image1</a>.props.vexpand = <span class="keyword">True</span>
<a name="l00297"></a>00297         self.stack.add_named(self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#ad04a197d8811a2ae2c72157bcff3e0c0">image1</a>, <span class="stringliteral">&quot;image1&quot;</span>)
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a50b9cbdcdba01cee1a218ecb2202b6d7">image2</a> = Gtk.Image()
<a name="l00300"></a>00300         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a50b9cbdcdba01cee1a218ecb2202b6d7">image2</a>.props.hexpand = <span class="keyword">True</span>
<a name="l00301"></a>00301         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a50b9cbdcdba01cee1a218ecb2202b6d7">image2</a>.props.vexpand = <span class="keyword">True</span>
<a name="l00302"></a>00302         self.stack.add_named(self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a50b9cbdcdba01cee1a218ecb2202b6d7">image2</a>, <span class="stringliteral">&quot;image2&quot;</span>)
<a name="l00303"></a>00303 
<a name="l00304"></a>00304         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a9d9f91f0da26469916fcd5386c905f6e">frame</a> = Gtk.AspectFrame.new(<span class="stringliteral">&quot;&quot;</span>, 0.5, 0.5, 1, <span class="keyword">False</span>)
<a name="l00305"></a>00305         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a6bbad8dddca67a3878ab64ca318606df">update_cover</a>(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>)
<a name="l00306"></a>00306         scroll = Gtk.ScrolledWindow()
<a name="l00307"></a>00307         scroll.add_with_viewport(self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a6464e57c9b46119f839aa84297d68cae">stack</a>)
<a name="l00308"></a>00308         scroll.set_policy(Gtk.PolicyType.NEVER, Gtk.PolicyType.NEVER)
<a name="l00309"></a>00309         scroll.set_resize_mode(Gtk.ResizeMode.QUEUE)
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         self.frame.add(scroll)
<a name="l00312"></a>00312         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a3abc33ccef7f87588a8df8bd35898fe8">_signal_connected</a> = <span class="keywordtype">None</span>
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         self.attach(self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a9d9f91f0da26469916fcd5386c905f6e">frame</a>, 6, 0, 1, 1)
<a name="l00315"></a>00315         self.connect(<span class="stringliteral">&#39;update-cover&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a6bbad8dddca67a3878ab64ca318606df">update_cover</a>)
<a name="l00316"></a>00316         self.connect(<span class="stringliteral">&#39;whats-playing&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a14c26ff37ab402d2af4ff0b899ee5690">display_whats_playing</a>)
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="comment">#lets fix the situation where some-themes background colour is incorrectly defined</span>
<a name="l00319"></a>00319         <span class="comment">#in these cases the background colour is black</span>
<a name="l00320"></a>00320         context = self.get_style_context()
<a name="l00321"></a>00321         bg_colour = context.get_background_color(Gtk.StateFlags.NORMAL)
<a name="l00322"></a>00322         <span class="keywordflow">if</span> bg_colour == Gdk.RGBA(0, 0, 0, 0):
<a name="l00323"></a>00323             color = context.get_color(Gtk.StateFlags.NORMAL)
<a name="l00324"></a>00324             self.override_background_color(Gtk.StateType.NORMAL, color)
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="keyword">def </span>update_cover(self, widget, source, entry):
<a name="l00327"></a>00327 
<a name="l00328"></a>00328         <span class="keywordflow">print</span> (<span class="stringliteral">&#39;update_cover&#39;</span>)
<a name="l00329"></a>00329         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a4cf125cb660a8c3c44df5b9dc38eff17">oldval</a> = 0  <span class="comment"># force a redraw</span>
<a name="l00330"></a>00330         <span class="keywordflow">if</span> entry:
<a name="l00331"></a>00331             <span class="keywordflow">print</span> (<span class="stringliteral">&#39;entry&#39;</span>)
<a name="l00332"></a>00332             album = source.album_manager.model.get_from_dbentry(entry)
<a name="l00333"></a>00333             self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a75972b79a4e6ec88a0a3fc51d5981359">pixbuf</a> = GdkPixbuf.Pixbuf().new_from_file(album.cover.original)
<a name="l00334"></a>00334             self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#af46027a101c586989833d2e89df6e3b8">window_resize</a>(<span class="keywordtype">None</span>)
<a name="l00335"></a>00335             self.frame.set_shadow_type(Gtk.ShadowType.NONE)
<a name="l00336"></a>00336         <span class="keywordflow">else</span>:
<a name="l00337"></a>00337             <span class="keywordflow">print</span> (<span class="stringliteral">&#39;no pixbuf&#39;</span>)
<a name="l00338"></a>00338             self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a75972b79a4e6ec88a0a3fc51d5981359">pixbuf</a> = <span class="keywordtype">None</span>
<a name="l00339"></a>00339             self.frame.set_shadow_type(Gtk.ShadowType.ETCHED_OUT)
<a name="l00340"></a>00340 
<a name="l00341"></a>00341         <span class="keywordflow">if</span> self.stack.get_visible_child_name() == <span class="stringliteral">&quot;image1&quot;</span>:
<a name="l00342"></a>00342             self.image1.queue_draw()
<a name="l00343"></a>00343         <span class="keywordflow">else</span>:
<a name="l00344"></a>00344             self.image2.queue_draw()
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <span class="keyword">def </span>display_whats_playing(self, show_playing):
<a name="l00347"></a>00347         view = self.get_child_at(0, 0)
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         view.display_playing_tracks(show_playing)
<a name="l00350"></a>00350 
<a name="l00351"></a>00351     <span class="keyword">def </span>window_resize(self, widget):
<a name="l00352"></a>00352         alloc = self.get_allocation()
<a name="l00353"></a>00353         <span class="keywordflow">if</span> alloc.height &lt; 10:
<a name="l00354"></a>00354             <span class="keywordflow">print</span> (<span class="stringliteral">&#39;less than&#39;</span>)
<a name="l00355"></a>00355             <span class="keywordflow">return</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         <span class="keywordflow">if</span> (alloc.width / 3) &lt;= (MIN_IMAGE_SIZE + 30) <span class="keywordflow">or</span> \
<a name="l00358"></a>00358                         (alloc.height) &lt;= (MIN_IMAGE_SIZE + 30):
<a name="l00359"></a>00359             self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a9d9f91f0da26469916fcd5386c905f6e">frame</a>.props.visible = <span class="keyword">False</span>
<a name="l00360"></a>00360         <span class="keywordflow">else</span>:
<a name="l00361"></a>00361             self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a9d9f91f0da26469916fcd5386c905f6e">frame</a>.props.visible = <span class="keyword">True</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363         framealloc = self.frame.get_allocation()
<a name="l00364"></a>00364         minval = min(framealloc.width - 30, framealloc.height - 30)
<a name="l00365"></a>00365         <span class="keywordflow">if</span> self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a4cf125cb660a8c3c44df5b9dc38eff17">oldval</a> == minval:
<a name="l00366"></a>00366             <span class="keywordflow">print</span> (self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a4cf125cb660a8c3c44df5b9dc38eff17">oldval</a>)
<a name="l00367"></a>00367             <span class="keywordflow">return</span>
<a name="l00368"></a>00368         print(<span class="stringliteral">&quot;resizing&quot;</span>)
<a name="l00369"></a>00369         <span class="keywordflow">print</span> (self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a75972b79a4e6ec88a0a3fc51d5981359">pixbuf</a>)
<a name="l00370"></a>00370         <span class="keywordflow">print</span> (minval)
<a name="l00371"></a>00371         self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a4cf125cb660a8c3c44df5b9dc38eff17">oldval</a> = minval
<a name="l00372"></a>00372         <span class="keywordflow">if</span> self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a75972b79a4e6ec88a0a3fc51d5981359">pixbuf</a>:
<a name="l00373"></a>00373             p = self.pixbuf.scale_simple(minval, minval, GdkPixbuf.InterpType.BILINEAR)
<a name="l00374"></a>00374         <span class="keywordflow">else</span>:
<a name="l00375"></a>00375             p = <span class="keywordtype">None</span>
<a name="l00376"></a>00376 
<a name="l00377"></a>00377         <span class="keywordflow">if</span> self.stack.get_visible_child_name() == <span class="stringliteral">&quot;image1&quot;</span>:
<a name="l00378"></a>00378             self.image2.set_from_pixbuf(p)
<a name="l00379"></a>00379             self.stack.set_visible_child_name(<span class="stringliteral">&quot;image2&quot;</span>)
<a name="l00380"></a>00380         <span class="keywordflow">else</span>:
<a name="l00381"></a>00381             self.image1.set_from_pixbuf(p)
<a name="l00382"></a>00382             self.stack.set_visible_child_name(<span class="stringliteral">&quot;image1&quot;</span>)
<a name="l00383"></a>00383 
<a name="l00384"></a>00384     <span class="keyword">def </span>change_view(self, entry_view, show_coverart):
<a name="l00385"></a>00385         print(<span class="stringliteral">&quot;debug - change_view&quot;</span>)
<a name="l00386"></a>00386         widget = self.get_child_at(0, 0)
<a name="l00387"></a>00387         <span class="keywordflow">if</span> widget:
<a name="l00388"></a>00388             self.remove(widget)
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="keywordflow">if</span> <span class="keywordflow">not</span> show_coverart:
<a name="l00391"></a>00391             widget = self.get_child_at(6, 0)
<a name="l00392"></a>00392             <span class="keywordflow">if</span> widget:
<a name="l00393"></a>00393                 self.remove(widget)
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         entry_view.props.hexpand = <span class="keyword">True</span>
<a name="l00396"></a>00396         entry_view.props.vexpand = <span class="keyword">True</span>
<a name="l00397"></a>00397         self.attach(entry_view, 0, 0, 3, 1)
<a name="l00398"></a>00398 
<a name="l00399"></a>00399         <span class="keywordflow">if</span> show_coverart:
<a name="l00400"></a>00400             self.attach(self.<a class="code" href="classcoverart__entryview_1_1_results_grid.html#a9d9f91f0da26469916fcd5386c905f6e">frame</a>, 6, 0, 1, 1)
<a name="l00401"></a>00401 
<a name="l00402"></a>00402         self.show_all()
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="classcoverart__entryview_1_1_base_view.html">00405</a> <span class="keyword">class </span><a class="code" href="classcoverart__entryview_1_1_base_view.html">BaseView</a>(RB.EntryView):
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="classcoverart__entryview_1_1_base_view.html#a84e47446c10e60f645580dc47b55ce9d">00407</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_base_view.html#a84e47446c10e60f645580dc47b55ce9d">__init__</a>(self, shell, source):
<a name="l00408"></a>00408         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00409"></a>00409 <span class="stringliteral">        Initializes the entryview.</span>
<a name="l00410"></a>00410 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00411"></a>00411         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a68e720ee31cfeb6b6ad4d62228cdec2f">shell</a> = shell
<a name="l00412"></a>00412         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#abbb0cc8d53534de59a61a81c22428a9c">source</a> = source
<a name="l00413"></a>00413         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a7383acd8a244509c8168d32b5e03499b">plugin</a> = self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#abbb0cc8d53534de59a61a81c22428a9c">source</a>.props.plugin
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         super(RB.EntryView, self).<a class="code" href="classcoverart__entryview_1_1_base_view.html#a84e47446c10e60f645580dc47b55ce9d">__init__</a>(db=shell.props.db,
<a name="l00416"></a>00416                                            shell_player=shell.props.shell_player, is_drag_source=<span class="keyword">True</span>,
<a name="l00417"></a>00417                                            visible_columns=[])
<a name="l00418"></a>00418 
<a name="l00419"></a>00419         cl = <a class="code" href="classcoverart__browser__prefs_1_1_cover_locale.html">CoverLocale</a>()
<a name="l00420"></a>00420         cl.switch_locale(cl.Locale.RB)
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#afe5c64cf51ee338f71706dbaa87c17eb">display_columns</a>()
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         cl.switch_locale(cl.Locale.LOCALE_DOMAIN)
<a name="l00425"></a>00425 
<a name="l00426"></a>00426         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ae84bc5f85540a2deaad3eb52bcf5fb97">define_menu</a>()
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         <span class="comment"># connect signals to the shell to know when the playing state changes</span>
<a name="l00429"></a>00429         self.shell.props.shell_player.connect(<span class="stringliteral">&#39;playing-song-changed&#39;</span>,
<a name="l00430"></a>00430                                               self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a132358a836747073f5b6b0c8eaa6a227">playing_song_changed</a>)
<a name="l00431"></a>00431         self.shell.props.shell_player.connect(<span class="stringliteral">&#39;playing-changed&#39;</span>,
<a name="l00432"></a>00432                                               self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a07e6dc273f7749b3cf7234c10d2a925b">playing_changed</a>)
<a name="l00433"></a>00433 
<a name="l00434"></a>00434         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#af5dbd1fa97ee58503caebe84f349dda5">actiongroup</a> = <a class="code" href="classcoverart__rb3compat_1_1_action_group.html">ActionGroup</a>(self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a68e720ee31cfeb6b6ad4d62228cdec2f">shell</a>, <span class="stringliteral">&#39;coverentryplaylist_submenu&#39;</span>)
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a7f22ac29d5e0650e2688bf7240117766">external_plugins</a> = <span class="keywordtype">None</span>
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a099e0a88af1a001904ea829bf252b360">source_query_model</a> = self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#abbb0cc8d53534de59a61a81c22428a9c">source</a>.source_query_model  <span class="comment"># RB.RhythmDBQueryModel.new_empty(self.shell.props.db)</span>
<a name="l00439"></a>00439         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ac118ec9ee3320fc28c190b51a6382e6b">qm</a> = RB.RhythmDBQueryModel.new_empty(self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a68e720ee31cfeb6b6ad4d62228cdec2f">shell</a>.props.db)
<a name="l00440"></a>00440         self.set_model(self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ac118ec9ee3320fc28c190b51a6382e6b">qm</a>)
<a name="l00441"></a>00441 
<a name="l00442"></a>00442         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#aa53c41d580fcd287a153483c16112426">connect_library_signals</a>()
<a name="l00443"></a>00443         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a36f66c0d34bea0995ea576c612fafb11">echonest_similar_playlist</a> = <span class="keywordtype">None</span>
<a name="l00444"></a>00444         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a00312f57d77584c4b5a987fc34eede03">echonest_similar_genre_playlist</a> = <span class="keywordtype">None</span>
<a name="l00445"></a>00445         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ab28c161f4a9970c458708dbbb9b3a8cf">lastfm_similar_playlist</a> = <span class="keywordtype">None</span>
<a name="l00446"></a>00446 
<a name="l00447"></a>00447         self.connect(<span class="stringliteral">&#39;selection-changed&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a3d59a4fdb53655fd549d72370c349465">selection_changed</a>)
<a name="l00448"></a>00448 
<a name="l00449"></a>00449         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ab6b38246b80828aba3caab6b68901c59">artists</a> = <span class="stringliteral">&quot;&quot;</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         <span class="keywordflow">print</span> (<span class="stringliteral">&quot;end constructor&quot;</span>)
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keyword">def </span>__del__(self):
<a name="l00454"></a>00454         del self.action_group
<a name="l00455"></a>00455         del self.play_action
<a name="l00456"></a>00456         del self.queue_action
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="keyword">def </span>connect_library_signals(self):
<a name="l00459"></a>00459         <span class="comment"># connect the sort-order to the library source sort</span>
<a name="l00460"></a>00460         library_view = self.shell.props.library_source.get_entry_view()
<a name="l00461"></a>00461         library_view.connect(<span class="stringliteral">&#39;notify::sort-order&#39;</span>,
<a name="l00462"></a>00462                              self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a7cec34d2517c8b86e330f74e3139f061">_on_library_sorting_changed</a>)
<a name="l00463"></a>00463         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a7cec34d2517c8b86e330f74e3139f061">_on_library_sorting_changed</a>(library_view,
<a name="l00464"></a>00464                                          library_view.props.sort_order)
<a name="l00465"></a>00465 
<a name="l00466"></a>00466         <span class="comment"># connect to the sort-order property</span>
<a name="l00467"></a>00467         self.connect(<span class="stringliteral">&#39;notify::sort-order&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#ac8aebce91282ba6487ad1e22969e5fa5">_notify_sort_order</a>,
<a name="l00468"></a>00468                      library_view)
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         self.set_columns_clickable(<span class="keyword">False</span>)
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="keyword">def </span>display_playing_tracks(self, show_playing):
<a name="l00474"></a>00474         <span class="keywordflow">pass</span>
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="keyword">def </span>define_menu(self):
<a name="l00477"></a>00477         <span class="keywordflow">pass</span>
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="keyword">def </span>display_columns(self):
<a name="l00480"></a>00480         <span class="keywordflow">pass</span>
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="keyword">def </span>selection_changed(self, entry_view):
<a name="l00483"></a>00483         entries = entry_view.get_selected_entries()
<a name="l00484"></a>00484         <span class="keywordflow">if</span> entries <span class="keywordflow">and</span> len(entries) &gt; 0:
<a name="l00485"></a>00485             self.source.entryviewpane.entry_view_results.emit(<span class="stringliteral">&#39;update-cover&#39;</span>, self.source, entries[0])
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="keyword">def </span>add_album(self, album):
<a name="l00488"></a>00488         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - add_album()&quot;</span>)
<a name="l00489"></a>00489         tracks = album.get_tracks()
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <span class="keywordflow">for</span> track <span class="keywordflow">in</span> tracks:
<a name="l00492"></a>00492             self.qm.add_entry(track.entry, -1)
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         (_, playing) = self.shell.props.shell_player.get_playing()
<a name="l00495"></a>00495         self.playing_changed(self.shell.props.shell_player, playing)
<a name="l00496"></a>00496 
<a name="l00497"></a>00497         artists = album.artists.split(<span class="stringliteral">&#39;, &#39;</span>)
<a name="l00498"></a>00498         <span class="keywordflow">if</span> self.artists == <span class="stringliteral">&quot;&quot;</span>:
<a name="l00499"></a>00499             self.artists = artists
<a name="l00500"></a>00500         <span class="keywordflow">else</span>:
<a name="l00501"></a>00501             self.artists = list(set(self.artists + artists))
<a name="l00502"></a>00502 
<a name="l00503"></a>00503         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - add_album()&quot;</span>)
<a name="l00504"></a>00504 
<a name="l00505"></a>00505     <span class="keyword">def </span>clear(self):
<a name="l00506"></a>00506         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - clear()&quot;</span>)
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         <span class="keywordflow">for</span> row <span class="keywordflow">in</span> self.qm:
<a name="l00509"></a>00509             self.qm.remove_entry(row[0])
<a name="l00510"></a>00510 
<a name="l00511"></a>00511         self.artists = <span class="stringliteral">&quot;&quot;</span>
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - clear()&quot;</span>)
<a name="l00514"></a>00514 
<a name="l00515"></a>00515     <span class="keyword">def </span>do_entry_activated(self, entry):
<a name="l00516"></a>00516         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - do_entry_activated()&quot;</span>)
<a name="l00517"></a>00517         self.select_entry(entry)
<a name="l00518"></a>00518         self.play_track_menu_item_callback(entry)
<a name="l00519"></a>00519         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - do_entry_activated()&quot;</span>)
<a name="l00520"></a>00520         <span class="keywordflow">return</span> <span class="keyword">True</span>
<a name="l00521"></a>00521 
<a name="l00522"></a>00522     <span class="keyword">def </span>pre_popup_menu_callback(self, *args):
<a name="l00523"></a>00523         <span class="keywordflow">pass</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525     <span class="keyword">def </span>do_show_popup(self, over_entry):
<a name="l00526"></a>00526         <span class="keywordflow">if</span> over_entry:
<a name="l00527"></a>00527             print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - do_show_popup()&quot;</span>)
<a name="l00528"></a>00528 
<a name="l00529"></a>00529             self.popup.popup(self.source,
<a name="l00530"></a>00530                              <span class="stringliteral">&#39;entryview_popup_menu&#39;</span>, 0, Gtk.get_current_event_time())
<a name="l00531"></a>00531 
<a name="l00532"></a>00532         <span class="keywordflow">return</span> over_entry
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="keyword">def </span>play_similar_artist_menu_item_callback(self, *args):
<a name="l00535"></a>00535         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.echonest_similar_playlist:
<a name="l00536"></a>00536             self.echonest_similar_playlist = \
<a name="l00537"></a>00537                 EchoNestPlaylist(self.shell,
<a name="l00538"></a>00538                                  self.shell.props.queue_source)
<a name="l00539"></a>00539 
<a name="l00540"></a>00540         selected = self.get_selected_entries()
<a name="l00541"></a>00541         entry = selected[0]
<a name="l00542"></a>00542         self.echonest_similar_playlist.start(entry, reinitialise=<span class="keyword">True</span>)
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <span class="keyword">def </span>play_similar_genre_menu_item_callback(self, *args):
<a name="l00545"></a>00545         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.echonest_similar_genre_playlist:
<a name="l00546"></a>00546             self.echonest_similar_genre_playlist = \
<a name="l00547"></a>00547                 EchoNestGenrePlaylist(self.shell,
<a name="l00548"></a>00548                                       self.shell.props.queue_source)
<a name="l00549"></a>00549 
<a name="l00550"></a>00550         selected = self.get_selected_entries()
<a name="l00551"></a>00551         entry = selected[0]
<a name="l00552"></a>00552         self.echonest_similar_genre_playlist.start(entry, reinitialise=<span class="keyword">True</span>)
<a name="l00553"></a>00553 
<a name="l00554"></a>00554     <span class="keyword">def </span>play_similar_track_menu_item_callback(self, *args):
<a name="l00555"></a>00555         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.lastfm_similar_playlist:
<a name="l00556"></a>00556             self.lastfm_similar_playlist = \
<a name="l00557"></a>00557                 LastFMTrackPlaylist(self.shell,
<a name="l00558"></a>00558                                     self.shell.props.queue_source)
<a name="l00559"></a>00559 
<a name="l00560"></a>00560         selected = self.get_selected_entries()
<a name="l00561"></a>00561         entry = selected[0]
<a name="l00562"></a>00562         self.lastfm_similar_playlist.start(entry, reinitialise=<span class="keyword">True</span>)
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <span class="keyword">def </span>play_track_menu_item_callback(self, *args):
<a name="l00566"></a>00566         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - play_track_menu_item_callback()&quot;</span>)
<a name="l00567"></a>00567 
<a name="l00568"></a>00568         <span class="keywordflow">for</span> row <span class="keywordflow">in</span> self.source_query_model:
<a name="l00569"></a>00569             self.source_query_model.remove_entry(row[0])
<a name="l00570"></a>00570 
<a name="l00571"></a>00571         selected = self.get_selected_entries()
<a name="l00572"></a>00572         entry = selected[0]
<a name="l00573"></a>00573 
<a name="l00574"></a>00574         <span class="keywordflow">if</span> len(selected) == 1:
<a name="l00575"></a>00575             self.source_query_model.copy_contents(self.qm)
<a name="l00576"></a>00576         <span class="keywordflow">else</span>:
<a name="l00577"></a>00577             self.add_tracks_to_source(self.source_query_model)
<a name="l00578"></a>00578 
<a name="l00579"></a>00579         self.source.props.query_model = self.source_query_model
<a name="l00580"></a>00580 
<a name="l00581"></a>00581         <span class="comment">#library_view = self.shell.props.library_source.get_entry_view()</span>
<a name="l00582"></a>00582         <span class="comment">#library_view.set_sorting_order(&#39;track-number&#39;, Gtk.SortType.ASCENDING)</span>
<a name="l00583"></a>00583         <span class="comment">#self.set_sorting_order(&#39;track-number&#39;, Gtk.SortType.ASCENDING)</span>
<a name="l00584"></a>00584 
<a name="l00585"></a>00585         <span class="comment"># Start the music</span>
<a name="l00586"></a>00586         player = self.shell.props.shell_player
<a name="l00587"></a>00587         player.play_entry(entry, self.source)
<a name="l00588"></a>00588 
<a name="l00589"></a>00589         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - play_track_menu_item_callback()&quot;</span>)
<a name="l00590"></a>00590 
<a name="l00591"></a>00591     <span class="keyword">def </span>queue_track_menu_item_callback(self, *args):
<a name="l00592"></a>00592         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - queue_track_menu_item_callback()&quot;</span>)
<a name="l00593"></a>00593 
<a name="l00594"></a>00594         self.add_tracks_to_source(self.shell.props.queue_source)
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="keyword">def </span>add_to_playing_menu_item_callback(self, *args):
<a name="l00597"></a>00597         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - add_to_playing_menu_item_callback()&quot;</span>)
<a name="l00598"></a>00598         self.add_tracks_to_source(<span class="keywordtype">None</span>)
<a name="l00599"></a>00599 
<a name="l00600"></a>00600     <span class="keyword">def </span>add_tracks_to_source(self, source):
<a name="l00601"></a>00601 
<a name="l00602"></a>00602         <span class="keywordflow">if</span> source == <span class="keywordtype">None</span>:
<a name="l00603"></a>00603             source = self.source_query_model
<a name="l00604"></a>00604 
<a name="l00605"></a>00605         selected = self.get_selected_entries()
<a name="l00606"></a>00606         selected.reverse()
<a name="l00607"></a>00607 
<a name="l00608"></a>00608         selected = sorted(selected,
<a name="l00609"></a>00609                           key=<span class="keyword">lambda</span> song: song.get_ulong(RB.RhythmDBPropType.TRACK_NUMBER))
<a name="l00610"></a>00610 
<a name="l00611"></a>00611         <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> selected:
<a name="l00612"></a>00612             source.add_entry(entry, -1)
<a name="l00613"></a>00613 
<a name="l00614"></a>00614         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - queue_track_menu_item_callback()&quot;</span>)
<a name="l00615"></a>00615 
<a name="l00616"></a><a class="code" href="classcoverart__entryview_1_1_base_view.html#a7a18dfe7e75fe51491c66f7e4503d54a">00616</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_base_view.html#a7a18dfe7e75fe51491c66f7e4503d54a">love_track</a>(self, rating):
<a name="l00617"></a>00617         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00618"></a>00618 <span class="stringliteral">        utility function to set the rating for selected tracks</span>
<a name="l00619"></a>00619 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00620"></a>00620         selected = self.get_selected_entries()
<a name="l00621"></a>00621 
<a name="l00622"></a>00622         <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> selected:
<a name="l00623"></a>00623             self.shell.props.db.entry_set(entry, RB.RhythmDBPropType.RATING,
<a name="l00624"></a>00624                                           rating)
<a name="l00625"></a>00625 
<a name="l00626"></a>00626         self.shell.props.db.commit()
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keyword">def </span>show_properties_menu_item_callback(self, *args):
<a name="l00629"></a>00629         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - show_properties_menu_item_callback()&quot;</span>)
<a name="l00630"></a>00630 
<a name="l00631"></a>00631         info_dialog = RB.SongInfo(source=self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#abbb0cc8d53534de59a61a81c22428a9c">source</a>, entry_view=self)
<a name="l00632"></a>00632         info_dialog.show_all()
<a name="l00633"></a>00633 
<a name="l00634"></a>00634         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - show_properties_menu_item_callback()&quot;</span>)
<a name="l00635"></a>00635 
<a name="l00636"></a>00636     <span class="keyword">def </span>playing_song_changed(self, shell_player, entry):
<a name="l00637"></a>00637         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playing_song_changed()&quot;</span>)
<a name="l00638"></a>00638 
<a name="l00639"></a>00639         <span class="keywordflow">if</span> entry <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.get_entry_contained(entry):
<a name="l00640"></a>00640             self.set_state(RB.EntryViewState.PLAYING)
<a name="l00641"></a>00641         <span class="keywordflow">else</span>:
<a name="l00642"></a>00642             self.set_state(RB.EntryViewState.NOT_PLAYING)
<a name="l00643"></a>00643 
<a name="l00644"></a>00644         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playing_song_changed()&quot;</span>)
<a name="l00645"></a>00645 
<a name="l00646"></a>00646     <span class="keyword">def </span>playing_changed(self, shell_player, playing):
<a name="l00647"></a>00647         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playing_changed()&quot;</span>)
<a name="l00648"></a>00648         entry = shell_player.get_playing_entry()
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <span class="keywordflow">if</span> entry <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.get_entry_contained(entry):
<a name="l00651"></a>00651             <span class="keywordflow">if</span> playing:
<a name="l00652"></a>00652                 self.set_state(RB.EntryViewState.PLAYING)
<a name="l00653"></a>00653             <span class="keywordflow">else</span>:
<a name="l00654"></a>00654                 self.set_state(RB.EntryViewState.PAUSED)
<a name="l00655"></a>00655         <span class="keywordflow">else</span>:
<a name="l00656"></a>00656             self.set_state(RB.EntryViewState.NOT_PLAYING)
<a name="l00657"></a>00657 
<a name="l00658"></a>00658         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playing_changed()&quot;</span>)
<a name="l00659"></a>00659 
<a name="l00660"></a>00660     <span class="keyword">def </span>add_playlist_menu_item_callback(self, *args):
<a name="l00661"></a>00661         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - add_playlist_menu_item_callback&quot;</span>)
<a name="l00662"></a>00662         playlist_manager = self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a68e720ee31cfeb6b6ad4d62228cdec2f">shell</a>.props.playlist_manager
<a name="l00663"></a>00663         playlist = playlist_manager.new_playlist(_(<span class="stringliteral">&#39;New Playlist&#39;</span>), <span class="keyword">False</span>)
<a name="l00664"></a>00664 
<a name="l00665"></a>00665         self.<a class="code" href="classcoverart__entryview_1_1_base_view.html#a938a3d965833ae856cef208caba83bb4">add_tracks_to_source</a>(playlist)
<a name="l00666"></a>00666 
<a name="l00667"></a>00667     <span class="keyword">def </span>playlist_menu_item_callback(self, *args):
<a name="l00668"></a>00668         <span class="keywordflow">pass</span>
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <span class="keyword">def </span>add_to_static_playlist_menu_item_callback(self, action, param, args):
<a name="l00671"></a>00671         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - &quot;</span> + \
<a name="l00672"></a>00672               <span class="stringliteral">&quot;add_to_static_playlist_menu_item_callback&quot;</span>)
<a name="l00673"></a>00673 
<a name="l00674"></a>00674         playlist = args[<span class="stringliteral">&#39;playlist&#39;</span>]
<a name="l00675"></a>00675         self.add_tracks_to_source(playlist)
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     <span class="keyword">def </span>_on_library_sorting_changed(self, view, _):
<a name="l00678"></a>00678         self._old_sort_order = self.props.sort_order
<a name="l00679"></a>00679 
<a name="l00680"></a>00680         self.set_sorting_type(view.props.sort_order)
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <span class="keyword">def </span>_notify_sort_order(self, view, _, library_view):
<a name="l00683"></a>00683         <span class="keywordflow">if</span> self.props.sort_order != self._old_sort_order:
<a name="l00684"></a>00684             self.resort_model()
<a name="l00685"></a>00685 
<a name="l00686"></a>00686             <span class="comment"># update library source&#39;s view direction</span>
<a name="l00687"></a>00687             library_view.set_sorting_type(self.props.sort_order)
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 
<a name="l00690"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html">00690</a> <span class="keyword">class </span><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html">CoverArtCompactEntryView</a>(<a class="code" href="classcoverart__entryview_1_1_base_view.html">BaseView</a>):
<a name="l00691"></a>00691     __hash__ = GObject.__hash__
<a name="l00692"></a>00692 
<a name="l00693"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#ac366fac3859a80e5d0045696994271a2">00693</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#ac366fac3859a80e5d0045696994271a2">__init__</a>(self, shell, source):
<a name="l00694"></a>00694         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00695"></a>00695 <span class="stringliteral">        Initializes the entryview.</span>
<a name="l00696"></a>00696 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00697"></a>00697         super(CoverArtCompactEntryView, self).<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#ac366fac3859a80e5d0045696994271a2">__init__</a>(shell, source)
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     <span class="keyword">def </span>display_columns(self):
<a name="l00700"></a>00700 
<a name="l00701"></a>00701         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#a8d00235c66cc63a796644cab9d7a83ac">col_map</a> = OrderedDict([
<a name="l00702"></a>00702             (<span class="stringliteral">&#39;track-number&#39;</span>, RB.EntryViewColumn.TRACK_NUMBER),
<a name="l00703"></a>00703             (<span class="stringliteral">&#39;title&#39;</span>, RB.EntryViewColumn.TITLE),
<a name="l00704"></a>00704             (<span class="stringliteral">&#39;artist&#39;</span>, RB.EntryViewColumn.ARTIST),
<a name="l00705"></a>00705             (<span class="stringliteral">&#39;rating&#39;</span>, RB.EntryViewColumn.RATING),
<a name="l00706"></a>00706             (<span class="stringliteral">&#39;duration&#39;</span>, RB.EntryViewColumn.DURATION)
<a name="l00707"></a>00707         ])
<a name="l00708"></a>00708 
<a name="l00709"></a>00709         <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#a8d00235c66cc63a796644cab9d7a83ac">col_map</a>:
<a name="l00710"></a>00710             visible = <span class="keyword">False</span> <span class="keywordflow">if</span> entry == <span class="stringliteral">&#39;artist&#39;</span> <span class="keywordflow">else</span> <span class="keyword">True</span>
<a name="l00711"></a>00711             self.append_column(self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#a8d00235c66cc63a796644cab9d7a83ac">col_map</a>[entry], visible)
<a name="l00712"></a>00712 
<a name="l00713"></a>00713     <span class="keyword">def </span>add_album(self, album):
<a name="l00714"></a>00714         super(CoverArtCompactEntryView, self).add_album(album)
<a name="l00715"></a>00715 
<a name="l00716"></a>00716         <span class="keywordflow">if</span> len(self.artists) &gt; 1:
<a name="l00717"></a>00717             self.get_column(RB.EntryViewColumn.ARTIST).set_visible(<span class="keyword">True</span>)
<a name="l00718"></a>00718         <span class="keywordflow">else</span>:
<a name="l00719"></a>00719             self.get_column(RB.EntryViewColumn.ARTIST).set_visible(<span class="keyword">False</span>)
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     <span class="keyword">def </span>define_menu(self):
<a name="l00722"></a>00722         popup = <a class="code" href="classcoverart__rb3compat_1_1_menu.html">Menu</a>(self.plugin, self.shell)
<a name="l00723"></a>00723         popup.load_from_file(<span class="stringliteral">&#39;N/A&#39;</span>,
<a name="l00724"></a>00724                              <span class="stringliteral">&#39;ui/coverart_entryview_compact_pop_rb3.ui&#39;</span>)
<a name="l00725"></a>00725         signals = {
<a name="l00726"></a>00726             <span class="stringliteral">&#39;ev_compact_play_track_menu_item&#39;</span>: self.play_track_menu_item_callback,
<a name="l00727"></a>00727             <span class="stringliteral">&#39;ev_compact_queue_track_menu_item&#39;</span>: self.queue_track_menu_item_callback,
<a name="l00728"></a>00728             <span class="stringliteral">&#39;ev_compact_add_to_playing_menu_item&#39;</span>: self.add_to_playing_menu_item_callback,
<a name="l00729"></a>00729             <span class="stringliteral">&#39;ev_compact_new_playlist&#39;</span>: self.add_playlist_menu_item_callback,
<a name="l00730"></a>00730             <span class="stringliteral">&#39;ev_compact_show_properties_menu_item&#39;</span>: self.show_properties_menu_item_callback,
<a name="l00731"></a>00731             <span class="stringliteral">&#39;ev_compact_similar_track_menu_item&#39;</span>: self.play_similar_track_menu_item_callback,
<a name="l00732"></a>00732             <span class="stringliteral">&#39;ev_compact_similar_artist_menu_item&#39;</span>: self.play_similar_artist_menu_item_callback,
<a name="l00733"></a>00733             <span class="stringliteral">&#39;ev_compact_similar_genre_menu_item&#39;</span>: self.play_similar_genre_menu_item_callback}
<a name="l00734"></a>00734 
<a name="l00735"></a>00735         popup.connect_signals(signals)
<a name="l00736"></a>00736         popup.connect(<span class="stringliteral">&#39;pre-popup&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#addff4ddc16275e48ebf2092666f0cdad">pre_popup_menu_callback</a>)
<a name="l00737"></a>00737         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#af1f67d55dcd75551143f7dbf3c253966">popup</a> = popup
<a name="l00738"></a>00738 
<a name="l00739"></a>00739     <span class="keyword">def </span>playlist_menu_item_callback(self, *args):
<a name="l00740"></a>00740         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playlist_menu_item_callback&quot;</span>)
<a name="l00741"></a>00741 
<a name="l00742"></a>00742         self.source.playlist_fillmenu(self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#af1f67d55dcd75551143f7dbf3c253966">popup</a>, <span class="stringliteral">&#39;ev_compact_playlist_sub_menu_item&#39;</span>, <span class="stringliteral">&#39;ev_compact_playlist_section&#39;</span>,
<a name="l00743"></a>00743                                       self.actiongroup, self.add_to_static_playlist_menu_item_callback)
<a name="l00744"></a>00744 
<a name="l00745"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#addff4ddc16275e48ebf2092666f0cdad">00745</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#addff4ddc16275e48ebf2092666f0cdad">pre_popup_menu_callback</a>(self, *args):
<a name="l00746"></a>00746         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00747"></a>00747 <span class="stringliteral">        Callback when the popup menu is about to be displayed</span>
<a name="l00748"></a>00748 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00749"></a>00749 
<a name="l00750"></a>00750         state, sensitive = self.shell.props.shell_player.get_playing()
<a name="l00751"></a>00751         <span class="keywordflow">if</span> <span class="keywordflow">not</span> state:
<a name="l00752"></a>00752             sensitive = <span class="keyword">False</span>
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         self.popup.set_sensitive(<span class="stringliteral">&#39;ev_compact_add_to_playing_menu_item&#39;</span>, sensitive)
<a name="l00755"></a>00755 
<a name="l00756"></a>00756         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#a41571e519807ad07f11c471b154f5d24">external_plugins</a>:
<a name="l00757"></a>00757             self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#a41571e519807ad07f11c471b154f5d24">external_plugins</a> = \
<a name="l00758"></a>00758                 <a class="code" href="classcoverart__external__plugins_1_1_create_external_plugin_menu.html">CreateExternalPluginMenu</a>(<span class="stringliteral">&quot;ev_compact_entryview&quot;</span>, 5, self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#af1f67d55dcd75551143f7dbf3c253966">popup</a>)
<a name="l00759"></a>00759             self.external_plugins.create_menu(<span class="stringliteral">&#39;entryview_compact_popup_menu&#39;</span>)
<a name="l00760"></a>00760 
<a name="l00761"></a>00761         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_compact_entry_view.html#abb2e9d306ab5dc285481cd5344b8d031">playlist_menu_item_callback</a>()
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 
<a name="l00764"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html">00764</a> <span class="keyword">class </span><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html">CoverArtEntryView</a>(<a class="code" href="classcoverart__entryview_1_1_base_view.html">BaseView</a>):
<a name="l00765"></a>00765     __hash__ = GObject.__hash__
<a name="l00766"></a>00766 
<a name="l00767"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#aa41ddf95918cf8e316546b1604334ac1">00767</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#aa41ddf95918cf8e316546b1604334ac1">__init__</a>(self, shell, source):
<a name="l00768"></a>00768         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00769"></a>00769 <span class="stringliteral">        Initializes the entryview.</span>
<a name="l00770"></a>00770 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00771"></a>00771         super(CoverArtEntryView, self).<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#aa41ddf95918cf8e316546b1604334ac1">__init__</a>(shell, source)
<a name="l00772"></a>00772 
<a name="l00773"></a>00773     <span class="keyword">def </span>display_columns(self):
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a8c5dbb86cfa03ad3891b4c722b81d5c5">col_map</a> = OrderedDict([
<a name="l00776"></a>00776             (<span class="stringliteral">&#39;track-number&#39;</span>, RB.EntryViewColumn.TRACK_NUMBER),
<a name="l00777"></a>00777             (<span class="stringliteral">&#39;title&#39;</span>, RB.EntryViewColumn.TITLE),
<a name="l00778"></a>00778             (<span class="stringliteral">&#39;genre&#39;</span>, RB.EntryViewColumn.GENRE),
<a name="l00779"></a>00779             (<span class="stringliteral">&#39;artist&#39;</span>, RB.EntryViewColumn.ARTIST),
<a name="l00780"></a>00780             (<span class="stringliteral">&#39;album&#39;</span>, RB.EntryViewColumn.ALBUM),
<a name="l00781"></a>00781             (<span class="stringliteral">&#39;composer&#39;</span>, RB.EntryViewColumn.COMPOSER),
<a name="l00782"></a>00782             (<span class="stringliteral">&#39;date&#39;</span>, RB.EntryViewColumn.YEAR),
<a name="l00783"></a>00783             (<span class="stringliteral">&#39;duration&#39;</span>, RB.EntryViewColumn.DURATION),
<a name="l00784"></a>00784             (<span class="stringliteral">&#39;bitrate&#39;</span>, RB.EntryViewColumn.QUALITY),
<a name="l00785"></a>00785             (<span class="stringliteral">&#39;play-count&#39;</span>, RB.EntryViewColumn.PLAY_COUNT),
<a name="l00786"></a>00786             (<span class="stringliteral">&#39;beats-per-minute&#39;</span>, RB.EntryViewColumn.BPM),
<a name="l00787"></a>00787             (<span class="stringliteral">&#39;comment&#39;</span>, RB.EntryViewColumn.COMMENT),
<a name="l00788"></a>00788             (<span class="stringliteral">&#39;location&#39;</span>, RB.EntryViewColumn.LOCATION),
<a name="l00789"></a>00789             (<span class="stringliteral">&#39;rating&#39;</span>, RB.EntryViewColumn.RATING),
<a name="l00790"></a>00790             (<span class="stringliteral">&#39;last-played&#39;</span>, RB.EntryViewColumn.LAST_PLAYED),
<a name="l00791"></a>00791             (<span class="stringliteral">&#39;first-seen&#39;</span>, RB.EntryViewColumn.FIRST_SEEN)
<a name="l00792"></a>00792         ])
<a name="l00793"></a>00793 
<a name="l00794"></a>00794         <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a8c5dbb86cfa03ad3891b4c722b81d5c5">col_map</a>:
<a name="l00795"></a>00795             visible = <span class="keyword">True</span> <span class="keywordflow">if</span> entry == <span class="stringliteral">&#39;title&#39;</span> <span class="keywordflow">else</span> <span class="keyword">False</span>
<a name="l00796"></a>00796             self.append_column(self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a8c5dbb86cfa03ad3891b4c722b81d5c5">col_map</a>[entry], visible)
<a name="l00797"></a>00797 
<a name="l00798"></a>00798         <span class="comment"># connect the visible-columns global setting to update our entryview</span>
<a name="l00799"></a>00799         gs = <a class="code" href="classcoverart__browser__prefs_1_1_g_setting.html">GSetting</a>()
<a name="l00800"></a>00800         rhythm_settings = gs.get_setting(gs.Path.RBSOURCE)
<a name="l00801"></a>00801         rhythm_settings.connect(<span class="stringliteral">&#39;changed::visible-columns&#39;</span>,
<a name="l00802"></a>00802                                 self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a10175222d00cd19e0c2cb517066cda70">on_visible_columns_changed</a>)
<a name="l00803"></a>00803         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a10175222d00cd19e0c2cb517066cda70">on_visible_columns_changed</a>(rhythm_settings, <span class="stringliteral">&#39;visible-columns&#39;</span>)
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     <span class="keyword">def </span>on_visible_columns_changed(self, settings, key):
<a name="l00806"></a>00806         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - on_visible_columns_changed()&quot;</span>)
<a name="l00807"></a>00807         <span class="comment"># reset current columns</span>
<a name="l00808"></a>00808         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - end on_visible_columns_changed()&quot;</span>)
<a name="l00809"></a>00809         <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a8c5dbb86cfa03ad3891b4c722b81d5c5">col_map</a>:
<a name="l00810"></a>00810             col = self.get_column(self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a8c5dbb86cfa03ad3891b4c722b81d5c5">col_map</a>[entry])
<a name="l00811"></a>00811             <span class="keywordflow">if</span> entry <span class="keywordflow">in</span> settings[key]:
<a name="l00812"></a>00812                 col.set_visible(<span class="keyword">True</span>)
<a name="l00813"></a>00813             <span class="keywordflow">else</span>:
<a name="l00814"></a>00814                 <span class="keywordflow">if</span> entry != <span class="stringliteral">&#39;title&#39;</span>:
<a name="l00815"></a>00815                     col.set_visible(<span class="keyword">False</span>)
<a name="l00816"></a>00816 
<a name="l00817"></a>00817         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - end on_visible_columns_changed()&quot;</span>)
<a name="l00818"></a>00818 
<a name="l00819"></a>00819     <span class="keyword">def </span>define_menu(self):
<a name="l00820"></a>00820         popup = <a class="code" href="classcoverart__rb3compat_1_1_menu.html">Menu</a>(self.plugin, self.shell)
<a name="l00821"></a>00821         popup.load_from_file(<span class="stringliteral">&#39;N/A&#39;</span>,
<a name="l00822"></a>00822                              <span class="stringliteral">&#39;ui/coverart_entryview_full_pop_rb3.ui&#39;</span>)
<a name="l00823"></a>00823         signals = {
<a name="l00824"></a>00824             <span class="stringliteral">&#39;ev_full_play_track_menu_item&#39;</span>: self.play_track_menu_item_callback,
<a name="l00825"></a>00825             <span class="stringliteral">&#39;ev_full_queue_track_menu_item&#39;</span>: self.queue_track_menu_item_callback,
<a name="l00826"></a>00826             <span class="stringliteral">&#39;ev_full_add_to_playing_menu_item&#39;</span>: self.add_to_playing_menu_item_callback,
<a name="l00827"></a>00827             <span class="stringliteral">&#39;ev_full_new_playlist&#39;</span>: self.add_playlist_menu_item_callback,
<a name="l00828"></a>00828             <span class="stringliteral">&#39;ev_full_show_properties_menu_item&#39;</span>: self.show_properties_menu_item_callback,
<a name="l00829"></a>00829             <span class="stringliteral">&#39;ev_full_similar_track_menu_item&#39;</span>: self.play_similar_track_menu_item_callback,
<a name="l00830"></a>00830             <span class="stringliteral">&#39;ev_full_similar_artist_menu_item&#39;</span>: self.play_similar_artist_menu_item_callback,
<a name="l00831"></a>00831             <span class="stringliteral">&#39;ev_full_similar_genre_menu_item&#39;</span>: self.play_similar_genre_menu_item_callback}
<a name="l00832"></a>00832 
<a name="l00833"></a>00833         popup.connect_signals(signals)
<a name="l00834"></a>00834         popup.connect(<span class="stringliteral">&#39;pre-popup&#39;</span>, self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a3f0fd2dce3b4370794f610eab3349d77">pre_popup_menu_callback</a>)
<a name="l00835"></a>00835         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a57ed87cbf7ea5c82bfeb34ae7dddf489">popup</a> = popup
<a name="l00836"></a>00836 
<a name="l00837"></a>00837     <span class="keyword">def </span>playlist_menu_item_callback(self, *args):
<a name="l00838"></a>00838         print(<span class="stringliteral">&quot;CoverArtBrowser DEBUG - playlist_menu_item_callback&quot;</span>)
<a name="l00839"></a>00839 
<a name="l00840"></a>00840         self.source.playlist_fillmenu(self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a57ed87cbf7ea5c82bfeb34ae7dddf489">popup</a>, <span class="stringliteral">&#39;ev_full_playlist_sub_menu_item&#39;</span>, <span class="stringliteral">&#39;ev_full_playlist_section&#39;</span>,
<a name="l00841"></a>00841                                       self.actiongroup, self.add_to_static_playlist_menu_item_callback)
<a name="l00842"></a>00842 
<a name="l00843"></a><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a3f0fd2dce3b4370794f610eab3349d77">00843</a>     <span class="keyword">def </span><a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a3f0fd2dce3b4370794f610eab3349d77">pre_popup_menu_callback</a>(self, *args):
<a name="l00844"></a>00844         <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00845"></a>00845 <span class="stringliteral">        Callback when the popup menu is about to be displayed</span>
<a name="l00846"></a>00846 <span class="stringliteral">        &#39;&#39;&#39;</span>
<a name="l00847"></a>00847 
<a name="l00848"></a>00848         state, sensitive = self.shell.props.shell_player.get_playing()
<a name="l00849"></a>00849         <span class="keywordflow">if</span> <span class="keywordflow">not</span> state:
<a name="l00850"></a>00850             sensitive = <span class="keyword">False</span>
<a name="l00851"></a>00851 
<a name="l00852"></a>00852         self.popup.set_sensitive(<span class="stringliteral">&#39;ev_full_add_to_playing_menu_item&#39;</span>, sensitive)
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a29f65154eeca9f18ac92ddd1b95f1173">external_plugins</a>:
<a name="l00855"></a>00855             self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a29f65154eeca9f18ac92ddd1b95f1173">external_plugins</a> = \
<a name="l00856"></a>00856                 <a class="code" href="classcoverart__external__plugins_1_1_create_external_plugin_menu.html">CreateExternalPluginMenu</a>(<span class="stringliteral">&quot;ev_full_entryview&quot;</span>, 5, self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#a57ed87cbf7ea5c82bfeb34ae7dddf489">popup</a>)
<a name="l00857"></a>00857             self.external_plugins.create_menu(<span class="stringliteral">&#39;entryview_full_popup_menu&#39;</span>)
<a name="l00858"></a>00858 
<a name="l00859"></a>00859         self.<a class="code" href="classcoverart__entryview_1_1_cover_art_entry_view.html#afd63b73df92eeca377a7e7dcc31bce0e">playlist_menu_item_callback</a>()
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 GObject.type_register(CoverArtEntryView)
<a name="l00863"></a>00863 GObject.type_register(CoverArtCompactEntryView)
<a name="l00864"></a>00864 
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>coverart_entryview.py</b>      </li>

    <li class="footer">Generated on Sat Jun 28 2014 11:18:07 for CoverArt Browser by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
